# 绑定维护说明（长期更新）

用于记录哪些节点属于核心节点、哪些增强节点需要绑定，以及哪些节点可自由使用（当前无）。后续新增节点时，请同步更新本表。

## 1. 核心节点（支持绑定激活，但本身不强制绑定）
- 心宝❤Banana 核心生图：`BananaImageNode`
  - `binding_context` 为**可选输入**，用户可在完全不接入绑定的情况下自由使用生图能力。
  - 当提供绑定上下文且成功解析到**有效 API Key** 并至少成功生成一张图像时，会在本地注册表中将会话标记为 `activated`，供后置增强节点校验使用，同时重置前置节点的全局使用预算。
- 未来新增的心宝系列核心节点：新增后请补充到此列表，并确保在**不依赖绑定也能正常使用**的前提下，按需接入激活逻辑。

## 2. 需绑定的增强节点（必须接收有效绑定；后置节点要求已激活）
- 裁切贴回（后置）：`BananaLocalCropPaste`（需要已激活的绑定，使用 `require_activated`）。
- 掩膜对齐节点（前置）：`MaskBoundingBoxAligned`（新增绑定必选，使用 `enforce_front_budget`，受全局前置预算限制）。
- 绑定生成工具：`BananaBindingGenerate`（输出绑定上下文，须连接到核心与增强节点）。
- 兼容前置/后置的增强节点（如未来新增的多用途节点）：在核心前时按前置规则（使用 `enforce_front_budget`），放在核心后时按后置规则（使用 `require_activated`）。请在节点文档中明确标注其“可前置/可后置”属性。

## 3. 不需绑定的自由节点
- 图像分割-联合：`SegmentAnythingUltraLi`（自由节点，不再要求绑定，可单独使用）。
- 裁切预处理（前置）：`BananaLocalCropPreprocess`（完全自由节点，可在无绑定上下文的情况下运行；若提供 `binding_context`，仅随 `region_data` 透传以兼容贴回节点，不再做预算校验）。
- 如有新增无需绑定的节点，请在此列出，并说明原因/使用范围。

## 维护准则
- 新增核心节点：
  - 节点本身的生图/推理能力**不应依赖绑定上下文**，保持对普通用户友好；
  - 如需为增强节点提供激活能力，可接入可选的 `binding_context` 输入，并在**解析到有效 API Key 且至少成功生成一张图像后**调用激活逻辑（这会重置前置预算）。
- 新增增强节点：标明是前置（使用 `enforce_front_budget` + 全局前置预算）还是后置（需 `activated`，使用 `require_activated`）。
- 移除/调整绑定策略时，同步更新本文件、节点提示与错误文案。
